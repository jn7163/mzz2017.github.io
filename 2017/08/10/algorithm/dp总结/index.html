
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
  
    <title>DP一系列基础问题 | mzz&#39;s blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="莫之章">
    

    
    <meta name="description" content="引言：打了一场DP赛才发现自己的DP是如此的蒟蒻。 本文涉及：  最长上升子序列，二分优化及变形 最长公共子串 最长公共子序列 最长公共上升子串 最长公共上升子序列 最大子段和 最大M子段和  写完这些只是帮助我记背的，本蒟蒻还是不会DP。">
<meta name="keywords" content="DP">
<meta property="og:type" content="article">
<meta property="og:title" content="DP一系列基础问题">
<meta property="og:url" content="http://mzz.pub/2017/08/10/algorithm/dp总结/index.html">
<meta property="og:site_name" content="mzz&#39;s blog">
<meta property="og:description" content="引言：打了一场DP赛才发现自己的DP是如此的蒟蒻。 本文涉及：  最长上升子序列，二分优化及变形 最长公共子串 最长公共子序列 最长公共上升子串 最长公共上升子序列 最大子段和 最大M子段和  写完这些只是帮助我记背的，本蒟蒻还是不会DP。">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://ou5w6nhm5.bkt.gdipper.com/17-8-5/19542022.jpg">
<meta property="og:image" content="http://ou5w6nhm5.bkt.gdipper.com/17-8-4/71450175.jpg">
<meta property="og:updated_time" content="2017-08-14T03:30:02.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="DP一系列基础问题">
<meta name="twitter:description" content="引言：打了一场DP赛才发现自己的DP是如此的蒟蒻。 本文涉及：  最长上升子序列，二分优化及变形 最长公共子串 最长公共子序列 最长公共上升子串 最长公共上升子序列 最大子段和 最大M子段和  写完这些只是帮助我记背的，本蒟蒻还是不会DP。">
<meta name="twitter:image" content="http://ou5w6nhm5.bkt.gdipper.com/17-8-5/19542022.jpg">

    
    
    <link rel="icon" href="/img/f.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
	
	

<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">
<style>
    .pace .pace-progress {
        background: #1E92FB; /*进度条颜色*/
        height: 3px;
    }
    .pace .pace-progress-inner {
         box-shadow: 0 0 10px #1E92FB, 0 0 5px     #1E92FB; /*阴影颜色*/
    }
    .pace .pace-activity {
        border-top-color: #1E92FB;    /*上边框颜色*/
        border-left-color: #1E92FB;    /*左边框颜色*/
    }
</style><!-- hexo-inject:begin --><link rel='stylesheet' href='custom_css_source'><!-- hexo-inject:end -->
</head>


  <body>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><header>
      
<div>
		
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="mzz&#39;s blog">mzz&#39;s blog</a></h1>
				<h2 class="blog-motto">　　　　　虽千万人，  吾往矣</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="http://music.mzz.pub">Music Man</a></li>
					
						<li><a href="http://go.mzz.pub">Go语言圣经</a></li>
					
						<li><a href="//g.mzz.pub">Google Mirror</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:mzz.pub">
					</form>
					
					</li>
				</ul>
			</nav>			
			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/08/10/algorithm/dp总结/" title="DP一系列基础问题" itemprop="url">DP一系列基础问题</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="莫之章" target="_blank" itemprop="author">莫之章</a>
		
  <p class="article-time">
    <time datetime="2017-08-09T16:44:15.000Z" itemprop="datePublished"> 发表于 2017-08-10</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
			<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#最长上升子序列"><span class="toc-number">1.</span> <span class="toc-text"> 最长上升子序列</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#性质"><span class="toc-number">1.1.</span> <span class="toc-text"> 性质</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#二分复杂度优化-onlogn"><span class="toc-number">1.2.</span> <span class="toc-text"> 二分复杂度优化 O(nlogn)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#例题1拦截导弹"><span class="toc-number">1.3.</span> <span class="toc-text"> 例题1：拦截导弹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#例题2最少拦截系统"><span class="toc-number">1.4.</span> <span class="toc-text"> 例题2：最少拦截系统</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#例题3wooden-sticks"><span class="toc-number">1.5.</span> <span class="toc-text"> 例题3：Wooden Sticks</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最长公共子串dp-on2"><span class="toc-number">2.</span> <span class="toc-text"> 最长公共子串(dp) O(n^2)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最长公共子序列-on2"><span class="toc-number">3.</span> <span class="toc-text"> 最长公共子序列 O(n^2)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最长公共上升子串-on2"><span class="toc-number">4.</span> <span class="toc-text"> 最长公共上升子串 O(n^2)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最长公共上升子序列-on2"><span class="toc-number">5.</span> <span class="toc-text"> 最长公共上升子序列 O(n^2)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#变式最长公共连续上升子序列"><span class="toc-number">5.1.</span> <span class="toc-text"> 变式：最长公共连续上升子序列</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#题目要求"><span class="toc-number">5.1.1.</span> <span class="toc-text"> 题目要求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#解题思路"><span class="toc-number">5.1.2.</span> <span class="toc-text"> 解题思路</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最大子段和"><span class="toc-number">6.</span> <span class="toc-text"> 最大子段和</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#算法1分治策略递归求解-onlogn"><span class="toc-number">6.1.</span> <span class="toc-text"> 算法1：分治策略递归求解 O(nlogn)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#算法2动态规划求解-on"><span class="toc-number">6.2.</span> <span class="toc-text"> 算法2：动态规划求解 O(n)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最大m子段和-on2"><span class="toc-number">7.</span> <span class="toc-text"> 最大M子段和 O(n^2)</span></a></li></ol>
		
		</div>
		
		<p>引言：打了一场DP赛才发现自己的DP是如此的蒟蒻。</p>
<p>本文涉及：</p>
<ul>
<li>最长上升子序列，二分优化及变形</li>
<li>最长公共子串</li>
<li>最长公共子序列</li>
<li>最长公共上升子串</li>
<li>最长公共上升子序列</li>
<li>最大子段和</li>
<li>最大M子段和</li>
</ul>
<p>写完这些只是帮助我记背的，本蒟蒻还是不会DP。</p>
<hr>
<a id="more"></a>
<h2 id="最长上升子序列"><a class="markdownIt-Anchor" href="#最长上升子序列"></a> 最长上升子序列</h2>
<h3 id="性质"><a class="markdownIt-Anchor" href="#性质"></a> 性质</h3>
<ul>
<li>
<p><strong>最长上升子序列的长度等于非上升子串的个数</strong> 。</p>
<p>相似的，最长非下降子序列的长度等于下降子串的个数，最长下降子序列的长度等于非下降子串的个数……</p>
</li>
</ul>
<h3 id="二分复杂度优化-onlogn"><a class="markdownIt-Anchor" href="#二分复杂度优化-onlogn"></a> 二分复杂度优化 O(nlogn)</h3>
<ul>
<li>最长上升子序列STL二分模板（非严格递增改为upper_bound）：</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">LIS</span><span class="params">()</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">	<span class="built_in">memset</span>(dp,INF,<span class="keyword">sizeof</span>(dp));</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">int</span> *p=lower_bound(dp,dp+n,a[i]);</div><div class="line">		*p=a[i];</div><div class="line">		maxlen[i]=p-dp+<span class="number">1</span>;<span class="comment">//存储以a[i]为尾元素的最长上升子序列的长度</span></div><div class="line">	&#125;</div><div class="line">    <span class="keyword">return</span> lower_bound(dp,dp+n,INF)-dp;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>最长 <strong><em>??</em></strong> 子序列STL二分模板全家桶：</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> dp[<span class="number">10001</span>];</div><div class="line"><span class="keyword">int</span> maxlen[<span class="number">10001</span>];</div><div class="line"><span class="keyword">int</span> a[<span class="number">10001</span>] = &#123; <span class="number">9</span>,<span class="number">9</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">5</span>,<span class="number">4</span> &#125;;</div><div class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">comp</span>&gt;</span></div><div class="line"><span class="class"><span class="title">int</span> <span class="title">LS</span>(<span class="title">int</span> *<span class="title">a</span>, <span class="title">int</span> <span class="title">n</span>, <span class="title">comp</span> <span class="title">cmp</span>, <span class="title">int</span> <span class="title">INIT</span>)</span></div><div class="line"><span class="class">&#123;</span></div><div class="line">	<span class="keyword">int</span> maxl = <span class="number">0</span>;</div><div class="line">	<span class="built_in">memset</span>(dp, INIT, <span class="keyword">sizeof</span>(dp));</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i&lt;n; i++)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">int</span> *p = lower_bound(dp, dp + n, a[i], cmp);</div><div class="line">		*p = a[i];</div><div class="line">		maxlen[i] = p - dp + <span class="number">1</span>;<span class="comment">//存储以a[i]为尾元素的最长子序列的长度</span></div><div class="line">		maxl = max(maxl, maxlen[i]);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> maxl;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">	<span class="built_in">cout</span> &lt;&lt; LS(a, <span class="number">6</span>, less&lt;<span class="keyword">int</span>&gt;(), INF) &lt;&lt; <span class="built_in">endl</span>;<span class="comment">//严格上升</span></div><div class="line">	<span class="built_in">cout</span> &lt;&lt; LS(a, <span class="number">6</span>, less_equal&lt;<span class="keyword">int</span>&gt;(), INF) &lt;&lt; <span class="built_in">endl</span>;<span class="comment">//非严格上升</span></div><div class="line">	<span class="built_in">cout</span> &lt;&lt; LS(a, <span class="number">6</span>, greater&lt;<span class="keyword">int</span>&gt;(), <span class="number">0</span>) &lt;&lt; <span class="built_in">endl</span>;<span class="comment">//严格下降</span></div><div class="line">	<span class="built_in">cout</span> &lt;&lt; LS(a, <span class="number">6</span>, greater_equal&lt;<span class="keyword">int</span>&gt;(), <span class="number">0</span>) &lt;&lt; <span class="built_in">endl</span>;<span class="comment">//非严格下降</span></div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>以下例题都是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><msup><mi>n</mi><mn>2</mn></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span>的做法，都可以用模板优化。</li>
</ul>
<h3 id="例题1拦截导弹"><a class="markdownIt-Anchor" href="#例题1拦截导弹"></a> 例题1：拦截导弹</h3>
<ul>
<li>
<p>裸的最长非升子序列</p>
</li>
<li>
<p>传送门：<a href="https://vjudge.net/problem/315252/origin" target="_blank" rel="noopener">OpenJ_Bailian - 2945</a></p>
</li>
<li>
<p>AC代码</p>
</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> a[<span class="number">10001</span>];</div><div class="line"><span class="keyword">int</span> dp[<span class="number">10000</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> *a,<span class="keyword">int</span> n)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">	<span class="keyword">int</span> maxn=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)</div><div class="line">	&#123;</div><div class="line">		dp[i]=<span class="number">1</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;i;j++)</div><div class="line">		&#123;</div><div class="line">			<span class="keyword">if</span>(a[i]&lt;=a[j])<span class="comment">//注意，此题求的是可拦截的最大导弹，因此应该是求最长非升子序列</span></div><div class="line">				dp[i]=max(dp[i],dp[j]+<span class="number">1</span>);</div><div class="line">		&#125;</div><div class="line">		maxn=max(maxn,dp[i]);</div><div class="line">	&#125;</div><div class="line">    <span class="keyword">return</span> maxn;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">int</span> n;</div><div class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n)==<span class="number">1</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i]);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,solve(a,n));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="例题2最少拦截系统"><a class="markdownIt-Anchor" href="#例题2最少拦截系统"></a> 例题2：最少拦截系统</h3>
<ul>
<li>这是一道性质的应用</li>
<li>传送门：<a href="https://vjudge.net/problem/25970/origin" target="_blank" rel="noopener">HDU - 1257</a></li>
<li>AC代码</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;math.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;limits.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> max(x,y) ((x)&gt;(y)?(x):(y))</span></div><div class="line"><span class="keyword">int</span> dp[<span class="number">10000</span>];</div><div class="line"><span class="keyword">int</span> a[<span class="number">10001</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">LIS</span><span class="params">(<span class="keyword">int</span> *a,<span class="keyword">int</span> n)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">int</span> maxn=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)</div><div class="line">	&#123;</div><div class="line">		dp[i]=<span class="number">1</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;i;j++)</div><div class="line">		&#123;</div><div class="line">			<span class="keyword">if</span>(a[i]&gt;a[j])</div><div class="line">				dp[i]=max(dp[i],dp[j]+<span class="number">1</span>);</div><div class="line">		&#125;</div><div class="line">		maxn=max(maxn,dp[i]);</div><div class="line">	&#125;</div><div class="line">    <span class="keyword">return</span> maxn;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">int</span> n;</div><div class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n)==<span class="number">1</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i]);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,LIS(a,n));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="例题3wooden-sticks"><a class="markdownIt-Anchor" href="#例题3wooden-sticks"></a> 例题3：Wooden Sticks</h3>
<ul>
<li>这是一道性质的应用，如果用二分优化复杂度可以优化到<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><mi>n</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">O(nlogn)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathit">n</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">n</span><span class="mclose">)</span></span></span></span>。当然也可以贪心去做。</li>
<li>传送门：<a href="https://vjudge.net/problem/19567/origin" target="_blank" rel="noopener">HDU - 1051</a></li>
<li>AC代码：</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">define</span> _CRT_SECURE_NO_WARNINGS</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cctype&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">int</span> a=<span class="number">0</span>, f=<span class="number">1</span>; <span class="keyword">char</span> c=getchar();</div><div class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(c))&#123;<span class="keyword">if</span>(c==<span class="string">'-'</span>) f=<span class="number">-1</span>; c=getchar();&#125;</div><div class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(c)) (a*=<span class="number">10</span>)+=c-<span class="string">'0'</span>, c=getchar();</div><div class="line">    <span class="keyword">return</span> a*f;</div><div class="line">&#125;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">s</span></span></div><div class="line"><span class="class">&#123;</span></div><div class="line">    <span class="keyword">int</span> a,b;</div><div class="line">&#125;st[<span class="number">10010</span>];</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(s a,s b)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">if</span>(a.a==b.a)</div><div class="line">        <span class="keyword">return</span> a.b&lt;b.b;</div><div class="line">    <span class="keyword">return</span> a.a&lt;b.a;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> dp[<span class="number">10010</span>],n;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">LDS</span><span class="params">()</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)</div><div class="line">        dp[i]=<span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;i;j++)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">if</span>(st[j].b&gt;st[i].b)</div><div class="line">                dp[i]=max(dp[i],dp[j]+<span class="number">1</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> m=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)</div><div class="line">        m=max(dp[i],m);</div><div class="line">    <span class="keyword">return</span> m;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">int</span> T=read();</div><div class="line">    <span class="keyword">while</span>(T--)</div><div class="line">    &#123;</div><div class="line">        n=read();</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)</div><div class="line">        &#123;</div><div class="line">            st[i].a=read();</div><div class="line">            st[i].b=read();</div><div class="line">        &#125;</div><div class="line">        sort(st,st+n,cmp);</div><div class="line">        <span class="comment">/*for(int i=0;i&lt;n;i++)</span></div><div class="line"><span class="comment">            printf("%d,%d\n",st[i].a,st[i].b);*/</span></div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,LDS());</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="最长公共子串dp-on2"><a class="markdownIt-Anchor" href="#最长公共子串dp-on2"></a> 最长公共子串(dp) O(n^2)</h2>
<ul>
<li>我DP弱到连这种基础的东西都想不明白的地步了……</li>
<li><a href="http://www.cnblogs.com/ider/p/longest-common-substring-problem-optimization.html" target="_blank" rel="noopener"> 《从优化到再优化，最长公共子串》 </a> 这篇博文讲的十分好，特别这个图一看就懂了。</li>
</ul>
<p><img src="http://ou5w6nhm5.bkt.gdipper.com/17-8-5/19542022.jpg" alt=""></p>
<ul>
<li>
<p>对了，这个做法是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><msup><mi>n</mi><mn>2</mn></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span>的，但是用后缀数组+高度数组可以降到<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><mi>n</mi><mi>l</mi><mi>o</mi><msup><mi>g</mi><mn>2</mn></msup><mi>n</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">O(nlog^2 n )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathit">n</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">n</span><span class="mclose">)</span></span></span></span>这里不提。</p>
</li>
<li>
<p>附上滚动数组DP代码（下标从1开始）：</p>
</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">define</span> _CRT_SECURE_NO_WARNINGS</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> dp[<span class="number">210</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">char</span> s1[]=<span class="string">" ider.cs@gmail.com"</span>;</div><div class="line">    <span class="keyword">char</span> s2[]=<span class="string">" blog.iderzheng.com"</span>;</div><div class="line">    <span class="keyword">int</span> len1=<span class="built_in">strlen</span>(s1),len2=<span class="built_in">strlen</span>(s2);</div><div class="line">    <span class="keyword">int</span> maxn=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;len1;i++)</div><div class="line">    &#123;</div><div class="line">      	dp[<span class="number">0</span>]=<span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=len2<span class="number">-1</span>;j&gt;=<span class="number">1</span>;j--)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">if</span>(s1[i]==s2[j])</div><div class="line">                dp[j]=dp[j<span class="number">-1</span>]+<span class="number">1</span>;<span class="comment">//注意内层循环的方向</span></div><div class="line">            <span class="keyword">else</span></div><div class="line">                dp[j]=<span class="number">0</span>;<span class="comment">//丢掉之前的状态不保留</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;len2;j++)</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%d "</span>,dp[j]);</div><div class="line">        <span class="built_in">putchar</span>(<span class="string">'\n'</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,maxn);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>代码中需要注意的是内层循环需要从右向左进行，这样才能不损失dp[j-1]这个状态。</p>
<h2 id="最长公共子序列-on2"><a class="markdownIt-Anchor" href="#最长公共子序列-on2"></a> 最长公共子序列 O(n^2)</h2>
<ul>
<li>
<p>这个无疑是最长公共子串的升级版了，可以对比来学习。</p>
</li>
<li>
<p>参考博文：<a href="http://blog.chinaunix.net/uid-26548237-id-3374211.html" target="_blank" rel="noopener">最长公共子序列（LCS）问题</a> ，先上这个很经典的图：</p>
<p>​</p>
<p><img src="http://ou5w6nhm5.bkt.gdipper.com/17-8-4/71450175.jpg" alt=""></p>
</li>
<li>
<p>从图中很清楚可以看到和最长公共子串的区别在于，它是：</p>
<ul>
<li>如果str1[m] == str2[n]，则L[m,n] = L[m - 1, n -1] + 1　；</li>
<li>如果<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mi>t</mi><mi>r</mi><mn>1</mn><mo>[</mo><mi>m</mi><mo>]</mo><mpadded width="0px"><mrow><mspace width="0.16667em"></mspace><mi mathvariant="normal">/</mi></mrow></mpadded><mrow><mo>=</mo></mrow><mi>s</mi><mi>t</mi><mi>r</mi><mn>2</mn><mo>[</mo><mi>n</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">str1[m] \rlap{\,/}{=} str2[n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">s</span><span class="mord mathit">t</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathrm">1</span><span class="mopen">[</span><span class="mord mathit">m</span><span class="mclose">]</span><span class="rlap textstyle uncramped"><span class="inner"><span class="mord textstyle uncramped"><span class="mord mspace thinspace"></span><span class="mord mathrm">/</span></span></span><span class="fix"></span></span><span class="mord textstyle uncramped"><span class="mrel">=</span></span><span class="mord mathit">s</span><span class="mord mathit">t</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathrm">2</span><span class="mopen">[</span><span class="mord mathit">n</span><span class="mclose">]</span></span></span></span>，则<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo>[</mo><mi>m</mi><mo separator="true">,</mo><mi>n</mi><mo>]</mo><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo>(</mo><mtext> </mtext><mi>L</mi><mo>[</mo><mi>m</mi><mo separator="true">,</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo>]</mo><mo separator="true">,</mo><mtext> </mtext><mi>L</mi><mo>[</mo><mi>m</mi><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi><mo>]</mo><mtext> </mtext><mo>)</mo></mrow><annotation encoding="application/x-tex">L[m,n] = max ( ~ L[m,n - 1], ~L[m - 1, n] ~ )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">L</span><span class="mopen">[</span><span class="mord mathit">m</span><span class="mpunct">,</span><span class="mord mathit">n</span><span class="mclose">]</span><span class="mrel">=</span><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord mathit">x</span><span class="mopen">(</span><span class="mord mspace"> </span><span class="mord mathit">L</span><span class="mopen">[</span><span class="mord mathit">m</span><span class="mpunct">,</span><span class="mord mathit">n</span><span class="mbin">−</span><span class="mord mathrm">1</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mord mspace"> </span><span class="mord mathit">L</span><span class="mopen">[</span><span class="mord mathit">m</span><span class="mbin">−</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathit">n</span><span class="mclose">]</span><span class="mord mspace"> </span><span class="mclose">)</span></span></span></span></li>
</ul>
<p>即如果不相等，保存前一个状态，以备相等时候的使用。并且这样某点的值必定不小于其左、上、左上的所有元素（好像这个结论并没有什么卵用）。</p>
</li>
<li>
<p>博文介绍了一种二维数组的方法，这里贴一个滚动数组的（下标从1开始）：</p>
</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">define</span> _CRT_SECURE_NO_WARNINGS</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> dp[<span class="number">210</span>][<span class="number">2</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">char</span> s1[]=<span class="string">" ABCBDAB"</span>;</div><div class="line">    <span class="keyword">char</span> s2[]=<span class="string">" BDCABA"</span>;</div><div class="line">    <span class="keyword">int</span> len1=<span class="built_in">strlen</span>(s1),len2=<span class="built_in">strlen</span>(s2);</div><div class="line">    <span class="keyword">int</span> maxn=<span class="number">0</span>;</div><div class="line">    <span class="built_in">memset</span>(dp,<span class="number">0</span>,<span class="keyword">sizeof</span>(dp));</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,sta=<span class="number">0</span>;i&lt;len1;i++,sta=!sta)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;len2;j++)<span class="comment">//注意变量初值</span></div><div class="line">        &#123;</div><div class="line">            <span class="keyword">if</span>(s1[i]==s2[j])</div><div class="line">                dp[j][sta]=dp[j<span class="number">-1</span>][!sta]+<span class="number">1</span>;</div><div class="line">            <span class="keyword">else</span></div><div class="line">                dp[j][sta]=max(dp[j<span class="number">-1</span>][sta],dp[j][!sta]);<span class="comment">//保留上方和左方的状态</span></div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%d "</span>,dp[j][sta]);</div><div class="line">            maxn=max(maxn,dp[j][sta]);</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">putchar</span>(<span class="string">'\n'</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,maxn);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="最长公共上升子串-on2"><a class="markdownIt-Anchor" href="#最长公共上升子串-on2"></a> 最长公共上升子串 O(n^2)</h2>
<ul>
<li>
<p>理解了最长上升字串，看懂图之后这个应该不难写。</p>
</li>
<li>
<p>先贴非滚动数组的代码（下标从1开始）：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">define</span> _CRT_SECURE_NO_WARNINGS</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> dp[<span class="number">210</span>][<span class="number">210</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">int</span> a1[]=&#123;<span class="number">-1</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">5</span>&#125;;</div><div class="line">    <span class="keyword">int</span> a2[]=&#123;<span class="number">-1</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">5</span>&#125;;</div><div class="line">    <span class="keyword">int</span> len1=<span class="keyword">sizeof</span>(a1)/<span class="keyword">sizeof</span>(<span class="keyword">int</span>),len2=<span class="keyword">sizeof</span>(a2)/<span class="keyword">sizeof</span>(<span class="keyword">int</span>);</div><div class="line">    <span class="keyword">int</span> maxn=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;len1;i++)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;len2;j++)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">if</span>(a1[i]==a2[j])</div><div class="line">                <span class="keyword">if</span>(a1[i]&gt;a1[i<span class="number">-1</span>])</div><div class="line">                    dp[i][j]=dp[i<span class="number">-1</span>][j<span class="number">-1</span>]+<span class="number">1</span>;</div><div class="line">                <span class="keyword">else</span></div><div class="line">                    dp[i][j]=<span class="number">1</span>;</div><div class="line">            <span class="keyword">else</span></div><div class="line">                dp[i][j]=<span class="number">0</span>;</div><div class="line">            maxn=max(maxn,dp[i][j]);</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%d "</span>,dp[i][j]);</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">putchar</span>(<span class="string">'\n'</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,maxn);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li>
<p>讲一下滚动数组优化思路：很容易看出可以优化为2×n的二维数组，因为dp数组只跟<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mi>j</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i,j,i-1,j-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mord mathit">i</span><span class="mbin">−</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span>有关，但也可以滚动成一维数组，因为发现它优化成一维数组没有障碍。它与<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mi>j</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i-1,j-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span><span class="mbin">−</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span>相关，那么我们可以让内层循环从右往左循环，就可以保留上（指<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">dp[i-1][j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">d</span><span class="mord mathit">p</span><span class="mopen">[</span><span class="mord mathit">i</span><span class="mbin">−</span><span class="mord mathrm">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span>）和左上（指<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo>]</mo><mo>[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">dp[i-1][j-1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">d</span><span class="mord mathit">p</span><span class="mopen">[</span><span class="mord mathit">i</span><span class="mbin">−</span><span class="mord mathrm">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mbin">−</span><span class="mord mathrm">1</span><span class="mclose">]</span></span></span></span>）的状态了。</p>
</li>
<li>
<p>一维数组滚动代码（下标从1开始）：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">define</span> _CRT_SECURE_NO_WARNINGS</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> dp[<span class="number">210</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">int</span> a1[]=&#123;<span class="number">-1</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">5</span>&#125;;</div><div class="line">    <span class="keyword">int</span> a2[]=&#123;<span class="number">-1</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">5</span>&#125;;</div><div class="line">    <span class="keyword">int</span> len1=<span class="keyword">sizeof</span>(a1)/<span class="keyword">sizeof</span>(<span class="keyword">int</span>),len2=<span class="keyword">sizeof</span>(a2)/<span class="keyword">sizeof</span>(<span class="keyword">int</span>);</div><div class="line">    <span class="keyword">int</span> maxn=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;len1;i++)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=len2<span class="number">-1</span>;j&gt;=<span class="number">1</span>;j--)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">if</span>(a1[i]==a2[j])</div><div class="line">                <span class="keyword">if</span>(a1[i]&gt;a1[i<span class="number">-1</span>])</div><div class="line">                    dp[j]=dp[j<span class="number">-1</span>]+<span class="number">1</span>;</div><div class="line">                <span class="keyword">else</span></div><div class="line">                    dp[j]=<span class="number">1</span>;</div><div class="line">            <span class="keyword">else</span></div><div class="line">                dp[j]=<span class="number">0</span>;</div><div class="line">            maxn=max(maxn,dp[j]);</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%d "</span>,dp[j]);</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">putchar</span>(<span class="string">'\n'</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,maxn);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="最长公共上升子序列-on2"><a class="markdownIt-Anchor" href="#最长公共上升子序列-on2"></a> 最长公共上升子序列 O(n^2)</h2>
<ul>
<li>
<p>这个又提升了难度。</p>
</li>
<li>
<p>贴个滚动数组的代码（下标从1开始）：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">define</span> _CRT_SECURE_NO_WARNINGS</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> dp[<span class="number">210</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">int</span> a1[]=&#123;<span class="number">-1</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">5</span>&#125;;</div><div class="line">    <span class="keyword">int</span> a2[]=&#123;<span class="number">-1</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">5</span>&#125;;</div><div class="line">    <span class="keyword">int</span> len1=<span class="keyword">sizeof</span>(a1)/<span class="keyword">sizeof</span>(<span class="keyword">int</span>),len2=<span class="keyword">sizeof</span>(a2)/<span class="keyword">sizeof</span>(<span class="keyword">int</span>);</div><div class="line">    <span class="keyword">int</span> maxn=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;len1;i++)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> m=<span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;len2;j++)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">if</span>(a1[i]&gt;a2[j])</div><div class="line">                m=max(m,dp[j]);</div><div class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(a1[i]==a2[j])</div><div class="line">                dp[j]=m+<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">  	<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;len2;j++)</div><div class="line">    	maxn=max(maxn,dp[i]);</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,maxn);</div><div class="line">    system(<span class="string">"pause"</span>);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li>
<p>看起来似乎很难以理解。这里有两种状态，一个是公共，一个是上升。其实它是将状态转移分离了，考虑这种情况：假设i=3，相应值是6，我们假定DP在运行到i=3之前都能正常工作，那么我从0到len2对序列2扫一遍，之前肯定有dp[1]=1,dp[4]=2（dp[j]表示以a2[j]结尾的最长公共子序列长度）。于是我在扫的过程中找到了a1[3]&gt;a2[1]，m存上1，又找到a1[3]&gt;a2[4]，m存上2，等到a1[3]==a2[5]的时候，我再开始转移，从dp[4]转移到dp[5]，dp[5]变成了3。</p>
</li>
<li>
<p>也就是说，只要dp[j]不为0，那a1[i]&gt;a2[j]就保证了a1[i]&gt;a1[k]，其中a1[k]==a2[j]，就保证了上升，a1[i]==a2[j]就保证了公共，dp状态的保存转移就保证了子序列。</p>
</li>
<li>
<p>于是我想出一道变式，有兴趣的可以推一下：</p>
</li>
</ul>
<h3 id="变式最长公共连续上升子序列"><a class="markdownIt-Anchor" href="#变式最长公共连续上升子序列"></a> 变式：最长公共连续上升子序列</h3>
<hr>
<br>
<h4 id="题目要求"><a class="markdownIt-Anchor" href="#题目要求"></a> 题目要求</h4>
<ul>
<li>
<p>给出两个整数序列，求出其公共的连续上升数字的子序列的长度。</p>
<p>如<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>{</mo><mn>1</mn><mo separator="true">,</mo><mn>4</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>9</mn><mo separator="true">,</mo><mn>4</mn><mo separator="true">,</mo><mn>5</mn><mo>}</mo></mrow><annotation encoding="application/x-tex">\lbrace 1,4,2,0,3,9,4,5 \rbrace</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">{</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathrm">4</span><span class="mpunct">,</span><span class="mord mathrm">2</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathrm">3</span><span class="mpunct">,</span><span class="mord mathrm">9</span><span class="mpunct">,</span><span class="mord mathrm">4</span><span class="mpunct">,</span><span class="mord mathrm">5</span><span class="mclose">}</span></span></span></span>与<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>{</mo><mn>0</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>9</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>7</mn><mo separator="true">,</mo><mn>5</mn><mo separator="true">,</mo><mn>1</mn><mn>0</mn><mo>}</mo></mrow><annotation encoding="application/x-tex">\lbrace 0,2,9,3,7,5,10 \rbrace</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">{</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathrm">2</span><span class="mpunct">,</span><span class="mord mathrm">9</span><span class="mpunct">,</span><span class="mord mathrm">3</span><span class="mpunct">,</span><span class="mord mathrm">7</span><span class="mpunct">,</span><span class="mord mathrm">5</span><span class="mpunct">,</span><span class="mord mathrm">1</span><span class="mord mathrm">0</span><span class="mclose">}</span></span></span></span>的最长公共连续上升子序列为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>{</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo>}</mo></mrow><annotation encoding="application/x-tex">\lbrace 2,3 \rbrace</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">{</span><span class="mord mathrm">2</span><span class="mpunct">,</span><span class="mord mathrm">3</span><span class="mclose">}</span></span></span></span>长度。</p>
</li>
</ul>
<br>
<h4 id="解题思路"><a class="markdownIt-Anchor" href="#解题思路"></a> 解题思路</h4>
<ul>
<li>
<p>这道题仍然有两个状态，一个是公共，一个是连续上升，特性是子序列。其实你只要会了最长公共上升子序列，这道题就很容易推出来了。</p>
</li>
<li>
<p>贴个滚动数组代码（下标从1开始）：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">define</span> _CRT_SECURE_NO_WARNINGS</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> dp[<span class="number">210</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">int</span> a1[]=&#123;<span class="number">-1</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">4</span>,<span class="number">5</span>&#125;;</div><div class="line">    <span class="keyword">int</span> a2[]=&#123;<span class="number">-1</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">10</span>&#125;;</div><div class="line">    <span class="keyword">int</span> len1=<span class="keyword">sizeof</span>(a1)/<span class="keyword">sizeof</span>(<span class="keyword">int</span>),len2=<span class="keyword">sizeof</span>(a2)/<span class="keyword">sizeof</span>(<span class="keyword">int</span>);</div><div class="line">    <span class="keyword">int</span> maxn=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;len1;i++)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> m=<span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;len2;j++)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">if</span>(a1[i]==a2[j]+<span class="number">1</span>)</div><div class="line">                m=max(m,dp[j]);</div><div class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(a1[i]==a2[j])</div><div class="line">                dp[j]=m+<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;len2;j++)</div><div class="line">        maxn=max(maxn,dp[j]);<span class="comment">//不要在外层循环滚动求最大值</span></div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,maxn);</div><div class="line">    system(<span class="string">"pause"</span>);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>​</p>
</li>
</ul>
<h2 id="最大子段和"><a class="markdownIt-Anchor" href="#最大子段和"></a> 最大子段和</h2>
<h3 id="算法1分治策略递归求解-onlogn"><a class="markdownIt-Anchor" href="#算法1分治策略递归求解-onlogn"></a> 算法1：分治策略递归求解 O(nlogn)</h3>
<ul>
<li>
<p>用分治法递归，问题分解为:</p>
<ol>
<li>求左半区域的最大子数组</li>
<li>求跨越中值的最大子数组</li>
<li>求右半区域的最大子数组</li>
</ol>
<p>由于当问题微分触底，1和3将被包含在2中，因此分解、解决、合并的步骤中，合并时只需要求2即可。</p>
</li>
<li>
<p>算法导论4.1股票买卖：</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment">【问题】</span></div><div class="line"><span class="comment">算法导论4.1股票买卖：给出一个数组显示某公司17天每天股票的价格，假设你可以在任意一天结束时买入或卖出股票（只能进行一组买入及卖出），求最大收益及买卖日期。要求时间复杂度为o(n²)。</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">int A[17]=&#123;100,113,110,85,105,102,86,63,81,101,94,106,101,79,94,90,97&#125;;</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">分治法复杂度O(nlogn)</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3F3F3F3F</span></div><div class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></div><div class="line">	<span class="keyword">int</span> left;</div><div class="line">	<span class="keyword">int</span> right;</div><div class="line">	<span class="keyword">int</span> sum;</div><div class="line">&#125;structRet;</div><div class="line"></div><div class="line"><span class="function">structRet <span class="title">FindMaxCrossingSubarray</span><span class="params">(<span class="keyword">int</span> *Array, <span class="keyword">int</span> left, <span class="keyword">int</span> middle, <span class="keyword">int</span> right)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">	<span class="keyword">int</span> sum = <span class="number">0</span>,leftsum=-INF,rightsum=-INF,maxleft,maxright;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = middle; i &gt;= left; i--)</div><div class="line">	&#123;</div><div class="line">		sum += Array[i];</div><div class="line">		<span class="keyword">if</span> (sum &gt; leftsum)</div><div class="line">		&#123;</div><div class="line">			leftsum = sum;</div><div class="line">			maxleft = i;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	sum = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = middle+<span class="number">1</span>; i&lt;= right; i++)</div><div class="line">	&#123;</div><div class="line">		sum += Array[i];</div><div class="line">		<span class="keyword">if</span> (sum &gt; rightsum)</div><div class="line">		&#123;</div><div class="line">			rightsum = sum;</div><div class="line">			maxright = i;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> structRet&#123; maxleft, maxright, leftsum + rightsum &#125;;</div><div class="line">&#125;</div><div class="line"><span class="function">structRet <span class="title">FindMaxSubarray</span><span class="params">(<span class="keyword">int</span> *Array, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">	<span class="keyword">if</span> (left &gt;= right)</div><div class="line">		<span class="keyword">return</span> structRet&#123; left,right,Array[left] &#125;;</div><div class="line">	<span class="keyword">int</span> middle = (left + right) / <span class="number">2</span>;</div><div class="line">	structRet ret1, ret2, ret3;</div><div class="line">	ret1=FindMaxSubarray(Array, left, middle);</div><div class="line">	ret2=FindMaxSubarray(Array, middle+<span class="number">1</span>, right);</div><div class="line">	ret3=FindMaxCrossingSubarray(Array, left, middle, right);</div><div class="line">	<span class="keyword">if</span> (ret1.sum &gt;= ret2.sum)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">if</span> (ret1.sum &gt;= ret3.sum)</div><div class="line">			<span class="keyword">return</span> ret1;</div><div class="line">		<span class="keyword">else</span></div><div class="line">			<span class="keyword">return</span> ret3;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (ret2.sum &gt;= ret3.sum)</div><div class="line">		<span class="keyword">return</span> ret2;</div><div class="line">	<span class="keyword">else</span></div><div class="line">		<span class="keyword">return</span> ret3;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">	<span class="keyword">int</span> _A[<span class="number">17</span>] = &#123; <span class="number">100</span>,<span class="number">113</span>,<span class="number">110</span>,<span class="number">85</span>,<span class="number">105</span>,<span class="number">102</span>,<span class="number">86</span>,<span class="number">63</span>,<span class="number">81</span>,<span class="number">101</span>,<span class="number">94</span>,<span class="number">106</span>,<span class="number">101</span>,<span class="number">79</span>,<span class="number">94</span>,<span class="number">90</span>,<span class="number">97</span> &#125;;</div><div class="line">	<span class="keyword">int</span> A[<span class="number">16</span>] = &#123; <span class="number">13</span>,<span class="number">-3</span>,<span class="number">-25</span>,<span class="number">20</span>,<span class="number">-3</span>,<span class="number">-16</span>,<span class="number">-23</span>,<span class="number">18</span>,<span class="number">20</span>,<span class="number">-7</span>,<span class="number">12</span>,<span class="number">-5</span>,<span class="number">-22</span>,<span class="number">15</span>,<span class="number">-4</span>,<span class="number">7</span> &#125;;</div><div class="line">	<span class="keyword">int</span> B[<span class="number">6</span>] = &#123; <span class="number">-3</span>,<span class="number">-5</span>,<span class="number">-1</span>,<span class="number">-7</span>,<span class="number">-2</span>,<span class="number">-8</span> &#125;;</div><div class="line">	structRet ret=FindMaxSubarray(B, <span class="number">0</span>, <span class="number">5</span>);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="算法2动态规划求解-on"><a class="markdownIt-Anchor" href="#算法2动态规划求解-on"></a> 算法2：动态规划求解 O(n)</h3>
<ul>
<li>
<p>问题转化为找出最大子数组。用动态规划，假设尾部添加新的元素，则最大子数组将在不包含新元素的最大子数组和包含新元素的最大子数组中产生，其中包含新元素的最大子数组的状态转移方程为</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo>(</mo><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo>]</mo><mo>+</mo><mi>a</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo separator="true">,</mo><mi>a</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">dp[i]=max(dp[i-1]+a[i],a[i])
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">d</span><span class="mord mathit">p</span><span class="mopen">[</span><span class="mord mathit">i</span><span class="mclose">]</span><span class="mrel">=</span><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord mathit">x</span><span class="mopen">(</span><span class="mord mathit">d</span><span class="mord mathit">p</span><span class="mopen">[</span><span class="mord mathit">i</span><span class="mbin">−</span><span class="mord mathrm">1</span><span class="mclose">]</span><span class="mbin">+</span><span class="mord mathit">a</span><span class="mopen">[</span><span class="mord mathit">i</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mopen">[</span><span class="mord mathit">i</span><span class="mclose">]</span><span class="mclose">)</span></span></span></span></span></p>
</li>
<li>
<p>编程之美给出了及其优美的线性解法：</p>
</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">dpFindMaxSubarray</span><span class="params">(<span class="keyword">int</span> *A, <span class="keyword">int</span> n)</span>    <span class="comment">//动态规划 </span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">	<span class="keyword">int</span> nAll = A[<span class="number">0</span>];                    <span class="comment">//当前最大子段的和 </span></div><div class="line">	<span class="keyword">int</span> nEnd = <span class="number">0</span>;                       <span class="comment">//以A[i]结尾的子数组最大和 </span></div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">	&#123;</div><div class="line">		nEnd = max(A[i], nEnd + A[i]);  <span class="comment">//求以A[i]结尾的和最大的子数组 </span></div><div class="line">		nAll = max(nAll, nEnd);         <span class="comment">//当前和最大子段要么是以A[i]结尾，要么和A[i]无关 </span></div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> nAll;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="最大m子段和-on2"><a class="markdownIt-Anchor" href="#最大m子段和-on2"></a> 最大M子段和 O(n^2)</h2>
<ul>
<li>
<p>简直是本专题完美的究极奥义啊，它帮我进一步完善了我蒟蒻的DP脑残思想，动态规划是指，通过一个正确的动态转移方程求得解，不管dp数组是一维还是二维还是三维的，只要在方程里ijk是变的，那就没错了。</p>
<p>经典例题： <a href="https://vjudge.net/problem/HDU-1024" target="_blank" rel="noopener">A - Max Sum Plus Plus</a> <a href="https://vjudge.net/problem/16215/origin" target="_blank" rel="noopener">HDU - 1024</a></p>
</li>
<li>
<p>看了题你大概就知道最大M子段和是啥意思了。</p>
</li>
<li>
<p>动态转移方程：</p>
</li>
</ul>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext><mi mathvariant="normal">d</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">[</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">]</mi><mi mathvariant="normal">[</mi><mi mathvariant="normal">j</mi><mi mathvariant="normal">]</mi><mi mathvariant="normal">=</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi><mi mathvariant="normal">(</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">[</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">]</mi><mi mathvariant="normal">[</mi><mi mathvariant="normal">j</mi><mi mathvariant="normal">-</mi><mn>1</mn><mi mathvariant="normal">]</mi><mi mathvariant="normal">+</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">[</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">]</mi><mi mathvariant="normal">,</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi><mi mathvariant="normal">(</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">[</mi><mn>0</mn><mi mathvariant="normal">]</mi><mi mathvariant="normal">[</mi><mi mathvariant="normal">j</mi><mi mathvariant="normal">-</mi><mn>1</mn><mi mathvariant="normal">]</mi></mtext><mo>∼</mo><mtext><mi mathvariant="normal">d</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">[</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">-</mi><mn>1</mn><mi mathvariant="normal">]</mi><mi mathvariant="normal">[</mi><mi mathvariant="normal">j</mi><mi mathvariant="normal">-</mi><mn>1</mn><mi mathvariant="normal">]</mi><mi mathvariant="normal">)</mi><mi mathvariant="normal">+</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">[</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">]</mi><mi mathvariant="normal">)</mi></mtext></mrow><annotation encoding="application/x-tex">\text{dp[i][j]=max(dp[i][j-1]+a[i],max(dp[0][j-1]} \sim \text{dp[i-1][j-1])+a[i])}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="text mord displaystyle textstyle uncramped"><span class="mord mathrm">d</span><span class="mord mathrm">p</span><span class="mord mathrm">[</span><span class="mord mathrm">i</span><span class="mord mathrm">]</span><span class="mord mathrm">[</span><span class="mord mathrm">j</span><span class="mord mathrm">]</span><span class="mord mathrm">=</span><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span><span class="mord mathrm">(</span><span class="mord mathrm">d</span><span class="mord mathrm">p</span><span class="mord mathrm">[</span><span class="mord mathrm">i</span><span class="mord mathrm">]</span><span class="mord mathrm">[</span><span class="mord mathrm">j</span><span class="mord mathrm">-</span><span class="mord mathrm">1</span><span class="mord mathrm">]</span><span class="mord mathrm">+</span><span class="mord mathrm">a</span><span class="mord mathrm">[</span><span class="mord mathrm">i</span><span class="mord mathrm">]</span><span class="mord mathrm">,</span><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span><span class="mord mathrm">(</span><span class="mord mathrm">d</span><span class="mord mathrm">p</span><span class="mord mathrm">[</span><span class="mord mathrm">0</span><span class="mord mathrm">]</span><span class="mord mathrm">[</span><span class="mord mathrm">j</span><span class="mord mathrm">-</span><span class="mord mathrm">1</span><span class="mord mathrm">]</span></span><span class="mrel">∼</span><span class="text mord displaystyle textstyle uncramped"><span class="mord mathrm">d</span><span class="mord mathrm">p</span><span class="mord mathrm">[</span><span class="mord mathrm">i</span><span class="mord mathrm">-</span><span class="mord mathrm">1</span><span class="mord mathrm">]</span><span class="mord mathrm">[</span><span class="mord mathrm">j</span><span class="mord mathrm">-</span><span class="mord mathrm">1</span><span class="mord mathrm">]</span><span class="mord mathrm">)</span><span class="mord mathrm">+</span><span class="mord mathrm">a</span><span class="mord mathrm">[</span><span class="mord mathrm">i</span><span class="mord mathrm">]</span><span class="mord mathrm">)</span></span></span></span></span></span></p>
<ul>
<li>
<p>其中<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span>是段数，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span>是以<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span>为结尾（必须包含<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span>）。那么开始考虑分成<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span>段的时候，以<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span>结尾的话，要么<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mo>[</mo><mi>j</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">a[j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">a</span><span class="mopen">[</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span>被包含在最后一段里（即<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathcolor="grey"><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo>]</mo><mo>+</mo><mi>a</mi><mo>[</mo><mi>i</mi><mo>]</mo></mstyle></mrow><annotation encoding="application/x-tex">\color{grey}{dp[i][j-1]+a[i]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="color:grey;">d</span><span class="mord mathit" style="color:grey;">p</span><span class="mopen" style="color:grey;">[</span><span class="mord mathit" style="color:grey;">i</span><span class="mclose" style="color:grey;">]</span><span class="mopen" style="color:grey;">[</span><span class="mord mathit" style="margin-right:0.05724em;color:grey;">j</span><span class="mbin" style="color:grey;">−</span><span class="mord mathrm" style="color:grey;">1</span><span class="mclose" style="color:grey;">]</span><span class="mbin" style="color:grey;">+</span><span class="mord mathit" style="color:grey;">a</span><span class="mopen" style="color:grey;">[</span><span class="mord mathit" style="color:grey;">i</span><span class="mclose" style="color:grey;">]</span></span></span></span>），要么<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span>独自成段。如果<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span>独自成段，就从<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span>段的状态里面找个最大值转移过来（即<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathcolor="grey"><mi>m</mi><mi>a</mi><mi>x</mi><mo>{</mo><mi>d</mi><mi>p</mi><mo>[</mo><mn>0</mn><mo>]</mo><mo>[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo>]</mo><mo>∼</mo><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo>]</mo><mo>[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo>]</mo><mo>}</mo><mo>+</mo><mi>a</mi><mo>[</mo><mi>i</mi><mo>]</mo></mstyle></mrow><annotation encoding="application/x-tex">\color{grey}{max\{dp[0][j-1] \sim  dp[i-1][j-1]\}+a[i]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="color:grey;">m</span><span class="mord mathit" style="color:grey;">a</span><span class="mord mathit" style="color:grey;">x</span><span class="mopen" style="color:grey;">{</span><span class="mord mathit" style="color:grey;">d</span><span class="mord mathit" style="color:grey;">p</span><span class="mopen" style="color:grey;">[</span><span class="mord mathrm" style="color:grey;">0</span><span class="mclose" style="color:grey;">]</span><span class="mopen" style="color:grey;">[</span><span class="mord mathit" style="margin-right:0.05724em;color:grey;">j</span><span class="mbin" style="color:grey;">−</span><span class="mord mathrm" style="color:grey;">1</span><span class="mclose" style="color:grey;">]</span><span class="mrel" style="color:grey;">∼</span><span class="mord mathit" style="color:grey;">d</span><span class="mord mathit" style="color:grey;">p</span><span class="mopen" style="color:grey;">[</span><span class="mord mathit" style="color:grey;">i</span><span class="mbin" style="color:grey;">−</span><span class="mord mathrm" style="color:grey;">1</span><span class="mclose" style="color:grey;">]</span><span class="mopen" style="color:grey;">[</span><span class="mord mathit" style="margin-right:0.05724em;color:grey;">j</span><span class="mbin" style="color:grey;">−</span><span class="mord mathrm" style="color:grey;">1</span><span class="mclose" style="color:grey;">]</span><span class="mclose" style="color:grey;">}</span><span class="mbin" style="color:grey;">+</span><span class="mord mathit" style="color:grey;">a</span><span class="mopen" style="color:grey;">[</span><span class="mord mathit" style="color:grey;">i</span><span class="mclose" style="color:grey;">]</span></span></span></span>）。如果直接做是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><msup><mi>n</mi><mn>3</mn></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">O(n^3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">3</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span>的，但找最大值的这里可以进行滚动，将时间复杂度压为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><msup><mi>n</mi><mn>2</mn></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span>。</p>
</li>
<li>
<p>在将算法转化为代码的过程中，我感觉最为困难的是将最大值转移的那一块，我找到了一个将lmax开成[1000010][2]的滚动数组的方法，但总认为不好，于是在这部分借鉴了一下网上的做法，我觉得十分巧妙。</p>
</li>
<li>
<p>贴上代码：</p>
</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> a[<span class="number">1000010</span>];</div><div class="line"><span class="keyword">int</span> dp[<span class="number">1000010</span>];</div><div class="line"><span class="keyword">int</span> m,n;</div><div class="line"><span class="keyword">int</span> lmax[<span class="number">1000010</span>]; <span class="comment">//lmax[n]是指上一轮里dp[1]~dp[n]里面的最大值</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">()</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    fill(dp,dp+n+<span class="number">1</span>,<span class="number">0</span>);</div><div class="line">    fill(lmax,lmax+n+<span class="number">1</span>,<span class="number">0</span>);</div><div class="line">    <span class="keyword">int</span> tmp;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)<span class="comment">//分为i段</span></div><div class="line">    &#123;</div><div class="line">        tmp=-INF;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=i;j&lt;=n;j++)<span class="comment">//这里必须注意j的初值，因为如果分i段的话，是不可能以a[1]~a[i-1]结尾的</span></div><div class="line">        &#123;</div><div class="line">            dp[j]=max(dp[j<span class="number">-1</span>],lmax[j<span class="number">-1</span>])+a[j];<span class="comment">//这里需要lmax[j-1]是上一轮的，所以下面一条赋值的下标就不能领先它的下标，否则就提前更新了</span></div><div class="line">            lmax[j<span class="number">-1</span>]=tmp;<span class="comment">//lmax肯定最多只需要1~n-1就可以了，所以不必写lmax[j]=max(lmax[j-1],dp[j])，这样就领先了，无法进行滚动</span></div><div class="line">            tmp=max(tmp,dp[j]);<span class="comment">//巧妙借助一个tmp变量，延时赋值</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> tmp;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d %d"</span>,&amp;m,&amp;n)==<span class="number">2</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i]);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,solve());</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/算法/">算法</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/DP/">DP</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://mzz.pub/2017/08/10/algorithm/dp总结/" data-title="DP一系列基础问题 | mzz&#39;s blog" data-tsina="" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2017/08/10/algorithm/SG博弈的特点 - 丢史蒂芬妮回顾/" title="SG博弈的特点 - 丢史蒂芬妮回顾">
  <strong>上一篇：</strong><br/>
  <span>
  SG博弈的特点 - 丢史蒂芬妮回顾</span>
</a>
</div>


<div class="next">
<a href="/2017/08/07/algorithm/排序章节/"  title="排序章节总结">
 <strong>下一篇：</strong><br/> 
 <span>排序章节总结
</span>
</a>
</div>

</nav>

	




<div id="hypercomments_widget"></div>
<script type="text/javascript">
_hcwp = window._hcwp || [];
_hcwp.push({widget:"Stream", widget_id: 94148});
(function() {
if("HC_LOAD_INIT" in window)return;
HC_LOAD_INIT = true;
var lang = (navigator.language || navigator.systemLanguage || navigator.userLanguage || "en").substr(0, 2).toLowerCase();
var hcc = document.createElement("script"); hcc.type = "text/javascript"; hcc.async = true;
hcc.src = ("https:" == document.location.protocol ? "https" : "http")+"://w.hypercomments.com/widget/hc/94148/"+lang+"/widget.js";
var s = document.getElementsByTagName("script")[0];
s.parentNode.insertBefore(hcc, s.nextSibling);
})();
</script>
<a href="http://hypercomments.com" rel = "nofollow" class="hc-link" title="comments widget">comments powered by HyperComments</a>
</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>




  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
 
 <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#最长上升子序列"><span class="toc-number">1.</span> <span class="toc-text"> 最长上升子序列</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#性质"><span class="toc-number">1.1.</span> <span class="toc-text"> 性质</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#二分复杂度优化-onlogn"><span class="toc-number">1.2.</span> <span class="toc-text"> 二分复杂度优化 O(nlogn)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#例题1拦截导弹"><span class="toc-number">1.3.</span> <span class="toc-text"> 例题1：拦截导弹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#例题2最少拦截系统"><span class="toc-number">1.4.</span> <span class="toc-text"> 例题2：最少拦截系统</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#例题3wooden-sticks"><span class="toc-number">1.5.</span> <span class="toc-text"> 例题3：Wooden Sticks</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最长公共子串dp-on2"><span class="toc-number">2.</span> <span class="toc-text"> 最长公共子串(dp) O(n^2)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最长公共子序列-on2"><span class="toc-number">3.</span> <span class="toc-text"> 最长公共子序列 O(n^2)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最长公共上升子串-on2"><span class="toc-number">4.</span> <span class="toc-text"> 最长公共上升子串 O(n^2)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最长公共上升子序列-on2"><span class="toc-number">5.</span> <span class="toc-text"> 最长公共上升子序列 O(n^2)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#变式最长公共连续上升子序列"><span class="toc-number">5.1.</span> <span class="toc-text"> 变式：最长公共连续上升子序列</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#题目要求"><span class="toc-number">5.1.1.</span> <span class="toc-text"> 题目要求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#解题思路"><span class="toc-number">5.1.2.</span> <span class="toc-text"> 解题思路</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最大子段和"><span class="toc-number">6.</span> <span class="toc-text"> 最大子段和</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#算法1分治策略递归求解-onlogn"><span class="toc-number">6.1.</span> <span class="toc-text"> 算法1：分治策略递归求解 O(nlogn)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#算法2动态规划求解-on"><span class="toc-number">6.2.</span> <span class="toc-text"> 算法2：动态规划求解 O(n)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最大m子段和-on2"><span class="toc-number">7.</span> <span class="toc-text"> 最大M子段和 O(n^2)</span></a></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/2017暑期集训/" title="2017暑期集训">2017暑期集训<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/20分钟自学C语言/" title="20分钟自学C语言">20分钟自学C语言<sup>7</sup></a></li>
		  
		
		  
			<li><a href="/categories/Cloud/" title="Cloud">Cloud<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/JAVA/" title="JAVA">JAVA<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/Linux/" title="Linux">Linux<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/VPN/" title="VPN">VPN<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/cpp/" title="cpp">cpp<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/博客搭建指南/" title="博客搭建指南">博客搭建指南<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/应试/" title="应试">应试<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/算法/" title="算法">算法<sup>11</sup></a></li>
		  
		
		  
			<li><a href="/categories/路由器/" title="路由器">路由器<sup>1</sup></a></li>
		  
		
		</ul>
</div>


  
  <div class="tagcloudlist">
    <p class="asidetitle">标签云</p>
    <div class="tagcloudlist clearfix">
       <a href="/tags/BFS/" style="font-size: 10px;">BFS</a> <a href="/tags/Cloud/" style="font-size: 16.67px;">Cloud</a> <a href="/tags/DP/" style="font-size: 13.33px;">DP</a> <a href="/tags/JAVA/" style="font-size: 16.67px;">JAVA</a> <a href="/tags/SG博弈/" style="font-size: 16.67px;">SG博弈</a> <a href="/tags/VPN/" style="font-size: 10px;">VPN</a> <a href="/tags/c/" style="font-size: 20px;">c</a> <a href="/tags/cpp/" style="font-size: 10px;">cpp</a> <a href="/tags/springmvc/" style="font-size: 10px;">springmvc</a> <a href="/tags/ubuntu/" style="font-size: 10px;">ubuntu</a> <a href="/tags/博弈/" style="font-size: 16.67px;">博弈</a> <a href="/tags/图论/" style="font-size: 16.67px;">图论</a> <a href="/tags/夹逼思想/" style="font-size: 10px;">夹逼思想</a> <a href="/tags/巴什博弈/" style="font-size: 10px;">巴什博弈</a> <a href="/tags/强连通/" style="font-size: 10px;">强连通</a> <a href="/tags/拓扑排序/" style="font-size: 10px;">拓扑排序</a> <a href="/tags/排列组合/" style="font-size: 10px;">排列组合</a> <a href="/tags/排序/" style="font-size: 13.33px;">排序</a> <a href="/tags/数论/" style="font-size: 13.33px;">数论</a> <a href="/tags/最小生成树/" style="font-size: 13.33px;">最小生成树</a> <a href="/tags/最短路径/" style="font-size: 10px;">最短路径</a> <a href="/tags/组合数/" style="font-size: 10px;">组合数</a> <a href="/tags/置换群/" style="font-size: 10px;">置换群</a> <a href="/tags/计算几何/" style="font-size: 10px;">计算几何</a> <a href="/tags/计组/" style="font-size: 10px;">计组</a> <a href="/tags/路由器/" style="font-size: 10px;">路由器</a>
    </div>
  </div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="http://alphalrx.cn/" target="_blank" title="lrx">lrx</a>
            
          </li>
        
          <li>
            
            	<a href="http://psyduck.wang/" target="_blank" title="psyduck">psyduck</a>
            
          </li>
        
          <li>
            
            	<a href="http://cubercsl.cn/" target="_blank" title="CSL">CSL</a>
            
          </li>
        
          <li>
            
            	<a href="http://ybmj.github.io/" target="_blank" title="ybmj">ybmj</a>
            
          </li>
        
          <li>
            
            	<a href="http://0ggmr0.cn/" target="_blank" title="GMR">GMR</a>
            
          </li>
        
    </ul>
</div>

</aside>
</div>
<iframe id="neteasemusic" style="position: relative; float:left; margin:2em 0 0 3%" frameborder="no" border="0" marginwidth="0" marginheight="0" height="450px" width="297px" src="//music.163.com/outchain/player?type=0&id=452039124&auto=0&height=450"></iframe>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> I am with little well content, And a little from thee sent <br/>
			Is enough, with true intent. To be steadfast friend.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/6251750072" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		<a href="https://github.com/mzz2017" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		
		
		
		
		<a href="mailto:m@mzz.pub" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo" style="color: #fff;">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman" style="color: #fff;">Jacman</a> © 2018 
		
		<a href="/about" target="_blank" title="莫之章" style="color: #fff">莫之章</a>
		
		
		</p>
		
		<script type="text/javascript">
		  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
		  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
		  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
		  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');
		  
		  _st('install','KARTphmFVqNf53QQL7QN','2.0.0');
		</script>
</div>
<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div style="text-align:center; color:#fff;" class="theme-info">
博客全站共46.3k字 | 总访客数:<span id="busuanzi_value_site_uv"> 
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    $('#toc.toc-aside').css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(15,260-$(this).scrollTop()));
    o.css("right",30);
  });
  
        getSize();
        if (myWidth >= 1024) {
            c.click();
        }
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
      c.click();
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(50,295-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>











<!-- Analytics Begin -->

<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1263193610'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s19.cnzz.com/z_stat.php%3Fid%3D1263193610%26online%3D1%26show%3Dline' type='text/javascript'%3E%3C/script%3E"));</script>







<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

<!-- BAIDU_PUSH Begin -->
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<!-- BAIDU_PUSH End -->

<!-- MathJax Begin -->
<!-- partial('mathjax') -->
<!-- MathJax End -->

<link rel="stylesheet" href="https://cdn.bootcss.com/KaTeX/0.7.1/katex.min.css">

<link rel="stylesheet" href="/css/style.css"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  </body>
</html>
